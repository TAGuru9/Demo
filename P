Sub ExportQADataWithHighlights()
    Dim wdApp As Object
    Dim wdDoc As Object
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim para As Object
    Dim overallStatus As String
    Dim rng As Object
    Dim highlightRange As Object
    Dim statusStart As Long

    ' Reference the worksheet
    Set ws = ThisWorkbook.Sheets(1)
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row

    ' Launch Word
    On Error Resume Next
    Set wdApp = GetObject(, "Word.Application")
    If wdApp Is Nothing Then Set wdApp = CreateObject("Word.Application")
    On Error GoTo 0

    If wdApp Is Nothing Then
        MsgBox "Could not start Word. Please make sure Word is installed.", vbCritical
        Exit Sub
    End If

    wdApp.Visible = True
    Set wdDoc = wdApp.Documents.Add

    ' Loop through each row of data
    For i = 2 To lastRow
        If Trim(ws.Cells(i, "A").Value) <> "" Then
            ' Header
            Set para = wdDoc.Paragraphs.Add
            para.Range.Text = ws.Cells(i, "A").Value & " â€“ RFC# " & ws.Cells(i, "C").Value
            para.Range.ListFormat.ApplyNumberDefault

            ' Overall Status bullet with color highlight
            overallStatus = Trim(ws.Cells(i, "B").Value)
            Set para = wdDoc.Paragraphs.Add
            para.Range.Text = "Overall Status: " & overallStatus
            para.Range.ListFormat.ApplyBulletDefault

            Set rng = para.Range
            statusStart = InStr(rng.Text, overallStatus)
            If statusStart > 0 Then
                Set highlightRange = rng.Duplicate
                highlightRange.Start = rng.Start + statusStart - 1
                highlightRange.End = highlightRange.Start + Len(overallStatus)

                Select Case LCase(overallStatus)
                    Case "green": highlightRange.HighlightColorIndex = 4 ' Light Green
                    Case "red": highlightRange.HighlightColorIndex = 6 ' Light Red
                    Case "yellow": highlightRange.HighlightColorIndex = 7 ' Yellow
                End Select
            End If

            ' Other bullet lines
            Set para = wdDoc.Paragraphs.Add: para.Range.Text = "Tower: " & ws.Cells(i, "D").Value: para.Range.ListFormat.ApplyBulletDefault
            Set para = wdDoc.Paragraphs.Add: para.Range.Text = "IA Team: " & ws.Cells(i, "E").Value: para.Range.ListFormat.ApplyBulletDefault
            Set para = wdDoc.Paragraphs.Add: para.Range.Text = "Status: " & ws.Cells(i, "F").Value: para.Range.ListFormat.ApplyBulletDefault
            Set para = wdDoc.Paragraphs.Add: para.Range.Text = "QA Start: " & Format(ws.Cells(i, "G").Value, "mm/dd/yyyy"): para.Range.ListFormat.ApplyBulletDefault
            Set para = wdDoc.Paragraphs.Add: para.Range.Text = "Actual QA End: " & Format(ws.Cells(i, "I").Value, "mm/dd/yyyy"): para.Range.ListFormat.ApplyBulletDefault
            Set para = wdDoc.Paragraphs.Add: para.Range.Text = "Prod Date: " & Format(ws.Cells(i, "K").Value, "mm/dd/yyyy"): para.Range.ListFormat.ApplyBulletDefault
            Set para = wdDoc.Paragraphs.Add: para.Range.Text = "Defects: " & ws.Cells(i, "P").Value: para.Range.ListFormat.ApplyBulletDefault
            Set para = wdDoc.Paragraphs.Add: para.Range.Text = "Total TCs: " & ws.Cells(i, "Q").Value: para.Range.ListFormat.ApplyBulletDefault
            Set para = wdDoc.Paragraphs.Add: para.Range.Text = "Automated TCs: " & ws.Cells(i, "R").Value: para.Range.ListFormat.ApplyBulletDefault

            wdDoc.Paragraphs.Add ' Extra space
        End If
    Next i

    MsgBox "QA Word export completed with highlights!", vbInformation
End Sub
