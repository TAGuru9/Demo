Sub ExportQADataWithHighlightsFinal()
    Dim wdApp As Object
    Dim wdDoc As Object
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim overallStatus As String
    Dim statusColorIndex As Integer
    Dim highlightStart As Long

    ' Set worksheet
    Set ws = ThisWorkbook.Sheets(1)
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row

    ' Launch Word safely
    On Error Resume Next
    Set wdApp = GetObject(, "Word.Application")
    If wdApp Is Nothing Then Set wdApp = CreateObject("Word.Application")
    On Error GoTo 0

    If wdApp Is Nothing Then
        MsgBox "Word could not start. Please ensure Word is installed.", vbCritical
        Exit Sub
    End If

    wdApp.Visible = True
    Set wdDoc = wdApp.Documents.Add

    ' Activate selection
    wdApp.Selection.TypeText Text:="QA Status Report"
    wdApp.Selection.TypeParagraph
    wdApp.Selection.TypeParagraph

    ' Loop through all rows
    For i = 2 To lastRow
        If Trim(ws.Cells(i, "A").Value) <> "" Then
            With wdApp.Selection
                ' Header line with numbering
                .ParagraphFormat.Reset
                .ParagraphFormat.SpaceAfter = 6
                .TypeText Text:=(i - 1) & ". " & ws.Cells(i, "A").Value & " – RFC# " & ws.Cells(i, "C").Value
                .TypeParagraph

                ' Bullet: Overall Status
                .ParagraphFormat.SpaceAfter = 0
                .ParagraphFormat.LeftIndent = InchesToPoints(0.25)
                .ParagraphFormat.FirstLineIndent = 0
                .ParagraphFormat.Bullet = True
                overallStatus = Trim(ws.Cells(i, "B").Value)
                .TypeText Text:="Overall Status: " & overallStatus
                highlightStart = InStr(.Paragraphs.Last.Range.Text, overallStatus)
                If highlightStart > 0 Then
                    With .Paragraphs.Last.Range.Characters(highlightStart).Duplicate
                        .MoveEnd Unit:=1, Count:=Len(overallStatus)
                        Select Case LCase(overallStatus)
                            Case "green": .HighlightColorIndex = 4
                            Case "yellow": .HighlightColorIndex = 7
                            Case "red": .HighlightColorIndex = 6
                        End Select
                    End With
                End If
                .TypeParagraph

                ' Add remaining bullets
                .TypeText Text:="Tower: " & ws.Cells(i, "D").Value: .TypeParagraph
                .TypeText Text:="IA Team: " & ws.Cells(i, "E").Value: .TypeParagraph
                .TypeText Text:="Status: " & ws.Cells(i, "F").Value: .TypeParagraph
                .TypeText Text:="QA Start: " & Format(ws.Cells(i, "G").Value, "mm/dd/yyyy"): .TypeParagraph
                .TypeText Text:="Actual QA End: " & Format(ws.Cells(i, "I").Value, "mm/dd/yyyy"): .TypeParagraph
                .TypeText Text:="Prod Date: " & Format(ws.Cells(i, "K").Value, "mm/dd/yyyy"): .TypeParagraph
                .TypeText Text:="Defects: " & ws.Cells(i, "P").Value: .TypeParagraph
                .TypeText Text:="Total TCs: " & ws.Cells(i, "Q").Value: .TypeParagraph
                .TypeText Text:="Automated TCs: " & ws.Cells(i, "R").Value: .TypeParagraph

                ' Reset bullet
                .ParagraphFormat.Bullet = False
                .TypeParagraph
            End With
        End If
    Next i

    MsgBox "✅ Export complete — all records are included with highlights!", vbInformation
End Sub
