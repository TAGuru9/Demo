import os
import json

# Root directory containing folders with JSON files
root_folder = '/path/to/your/folder'

# List to hold all row data
table_data = []

# Loop through folders and files
for dirpath, _, filenames in os.walk(root_folder):
    for file in filenames:
        if file.endswith('.json'):
            file_path = os.path.join(dirpath, file)
            with open(file_path, 'r') as f:
                try:
                    data = json.load(f)
                    # Append each dictionary or item
                    if isinstance(data, list):
                        table_data.extend(data)
                    elif isinstance(data, dict):
                        table_data.append(data)
                except json.JSONDecodeError:
                    print(f"Could not parse {file_path}")

# Get column headers from keys
if table_data:
    headers = table_data[0].keys()
    print("\t".join(headers))
    for row in table_data:
        print("\t".join(str(row.get(col, "")) for col in headers))
else:
    print("No JSON data found.")
